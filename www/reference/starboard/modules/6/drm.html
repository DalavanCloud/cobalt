<!DOCTYPE html>
<html lang="en" itemscope itemtype="https://schema.org/WebPage">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>Cobalt / Starboard Module Reference: drm.h</title>

            <!-- Webfont -->
    
    <link href='https://fonts.googleapis.com/css?family=Kavoon|Material+Icons' rel='stylesheet' type='text/css'>
    


    <!-- Material Design Lite -->
    <link href="/assets/material-design-lite/material.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <!-- Bootstrap -->
    <link href="/assets/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Styles -->
    <link rel="stylesheet" type="text/css" href="/css/site.css" />

    <!-- Font Awesome icons -->
    <link href="/assets/font-awesome-4.4.0/css/font-awesome.min.css"
          rel="stylesheet"
          type="text/css">
    
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="/assets/bootstrap/js/bootstrap.min.js"></script>

    <script src="https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js"></script>

    <!-- material design lite -->
    <script src="/assets/material-design-lite/material.min.js"></script>
    
    <!-- Include the common site javascript -->
    <script src="/js/common.js" type="text/javascript" charset="utf-8"></script>


    <!-- metadata -->
    <meta name="og:title" content="Cobalt / Starboard Module Reference: drm.h"/>
    <meta name="og:image" content="/images/cobalt-logo.png"/>
    <meta name="og:description" content="A high-performance, small-footprint platform that implements a subset of HTML5/CSS/JS to run applications, including the YouTube TV app."/>
  </head>
  <body class="docs" id="top_of_page">

    <span id="toc-depth" data-toc-depth="h2,h3"></span>



    <nav id="common-nav" class="navbar navbar-fixed-top inverse">
  <div class="container">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      
      <a class="navbar-brand" href="/">
        <img class="logo" src="/images/cobalt-logo.png" alt="Cobalt">
      </a>
      
    </div>

    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="navbar-collapse-1">
      <ul class="nav navbar-nav navbar-right" id="standard-menu-links">
        
  
    
  
  
    
      <li><a href="/starboard/porting.html">Porters</a></li>
    
  

  
    
  
  
    
      <li><a href="/development/setup-linux.html">Developers</a></li>
    
  

  
    
  
  
    
      <li><a href="/contributors/index.html">Contributors</a></li>
    
  

  
    
  
  
    
      
        <li><a href="https://cobalt.googlesource.com/cobalt">Code Repo</a></li>
      
    
  


      </ul>
      <ul class="nav nav-stacked mobile-left-nav-menu" id="collapsed-left-menu">
        
  
<li class="expand-container" data-expander-target-search="relative">
    
      
      
<h4 class="no-submenu no-top-margin"><a href="/overview.html">Overview</a></h4>
      
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
        
          <h4 class="submenu">Porters</h4>
        
      
  <ul class="content">
      
        
    <li><b>Guides</b>
          
      <ul>
            
              
        <li><a href="/starboard/porting.html">Port Cobalt to your platform</a></li>
              
            
              
        <li><a href="/starboard/testing.html">Testing with NPLB</a></li>
              
            
      </ul>
    </li>
          
        
      
        
    <li><b>Reference</b>
          
      <ul>
            
              
        <li><a href="/reference/starboard/configuration-public.html">configuration_public.h</a></li>
              
            
              
        <li><a href="/reference/starboard/gyp-configuration.html">gyp_configuration.gypi</a></li>
              
            
              
                <li><b>Starboard modules</b>
                
          <ul>
                  
                    
                      <li><a href="/reference/starboard/modules/accessibility.html">accessibility.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/atomic.html">atomic.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/audio_sink.html">audio_sink.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/blitter.html">blitter.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/byte_swap.html">byte_swap.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/character.html">character.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/condition_variable.html">condition_variable.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/configuration.html">configuration.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/cryptography.html">cryptography.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/decode_target.html">decode_target.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/directory.html">directory.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/double.html">double.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/drm.html">drm.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/event.html">event.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/export.html">export.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/file.html">file.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/image.html">image.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/input.html">input.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/key.html">key.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/log.html">log.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/media.html">media.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/memory.html">memory.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/memory_reporter.html">memory_reporter.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/microphone.html">microphone.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/mutex.html">mutex.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/once.html">once.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/player.html">player.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/queue.html">queue.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/socket.html">socket.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/socket_waiter.html">socket_waiter.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/speech_recognizer.html">speech_recognizer.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/speech_synthesis.html">speech_synthesis.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/spin_lock.html">spin_lock.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/storage.html">storage.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/string.html">string.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/system.html">system.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/thread.html">thread.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/thread_types.html">thread_types.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/time.html">time.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/time_zone.html">time_zone.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/types.html">types.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/user.html">user.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/window.html">window.h</a></li>
                    
                  
          </ul>
                
              
            
      </ul>
    </li>
          
        
      
  </ul>
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
        
          <h4 class="submenu">Developers</h4>
        
      
  <ul class="content">
      
        
    <li><b>Guides</b>
          
      <ul>
            
              
        <li><a href="/development/setup-linux.html">Setup - Linux</a></li>
              
            
              
        <li><a href="/development/setup-raspi.html">Setup - RasPi</a></li>
              
            
      </ul>
    </li>
          
        
      
        
    <li><b>Reference</b>
          
      <ul>
            
              
        <li><a href="/development/reference/supported-features.html">Cobalt support</a></li>
              
            
      </ul>
    </li>
          
        
      
  </ul>
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
      
<h4 class="no-submenu"><a href="/contributors/index.html">Contributors</a></h4>
      
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
      
<h4 class="no-submenu"><a href="/communication.html">Communication</a></h4>
      
    
</li>
  


        <li><a href="https://cobalt.googlesource.com/cobalt" id="collapsed-left-menu-repo-link"><i class="fa fa-github"></i> GitHub</a></li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container -->
</nav>


    
<div id="masthead">
  <div class="container">
    <div class="row">
      <div class="col-md-11">
        <h1>Starboard Module Reference: drm.h</h1>
      </div>
    </div>
  </div>
</div>


<div class="container">
    <div class="row scroll-margin" id="toc-content-row">
    <div class="col-md-2" id="leftCol">
      <ul class="nav nav-stacked mobile-left-nav-menu" id="sidebar">
        
  
<li class="expand-container" data-expander-target-search="relative">
    
      
      
<h4 class="no-submenu no-top-margin"><a href="/overview.html">Overview</a></h4>
      
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
        
          <h4 class="submenu">Porters</h4>
        
      
  <ul class="content">
      
        
    <li><b>Guides</b>
          
      <ul>
            
              
        <li><a href="/starboard/porting.html">Port Cobalt to your platform</a></li>
              
            
              
        <li><a href="/starboard/testing.html">Testing with NPLB</a></li>
              
            
      </ul>
    </li>
          
        
      
        
    <li><b>Reference</b>
          
      <ul>
            
              
        <li><a href="/reference/starboard/configuration-public.html">configuration_public.h</a></li>
              
            
              
        <li><a href="/reference/starboard/gyp-configuration.html">gyp_configuration.gypi</a></li>
              
            
              
                <li><b>Starboard modules</b>
                
          <ul>
                  
                    
                      <li><a href="/reference/starboard/modules/accessibility.html">accessibility.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/atomic.html">atomic.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/audio_sink.html">audio_sink.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/blitter.html">blitter.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/byte_swap.html">byte_swap.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/character.html">character.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/condition_variable.html">condition_variable.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/configuration.html">configuration.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/cryptography.html">cryptography.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/decode_target.html">decode_target.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/directory.html">directory.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/double.html">double.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/drm.html">drm.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/event.html">event.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/export.html">export.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/file.html">file.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/image.html">image.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/input.html">input.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/key.html">key.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/log.html">log.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/media.html">media.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/memory.html">memory.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/memory_reporter.html">memory_reporter.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/microphone.html">microphone.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/mutex.html">mutex.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/once.html">once.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/player.html">player.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/queue.html">queue.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/socket.html">socket.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/socket_waiter.html">socket_waiter.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/speech_recognizer.html">speech_recognizer.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/speech_synthesis.html">speech_synthesis.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/spin_lock.html">spin_lock.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/storage.html">storage.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/string.html">string.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/system.html">system.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/thread.html">thread.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/thread_types.html">thread_types.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/time.html">time.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/time_zone.html">time_zone.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/types.html">types.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/user.html">user.h</a></li>
                    
                  
                    
                      <li><a href="/reference/starboard/modules/window.html">window.h</a></li>
                    
                  
          </ul>
                
              
            
      </ul>
    </li>
          
        
      
  </ul>
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
        
          <h4 class="submenu">Developers</h4>
        
      
  <ul class="content">
      
        
    <li><b>Guides</b>
          
      <ul>
            
              
        <li><a href="/development/setup-linux.html">Setup - Linux</a></li>
              
            
              
        <li><a href="/development/setup-raspi.html">Setup - RasPi</a></li>
              
            
      </ul>
    </li>
          
        
      
        
    <li><b>Reference</b>
          
      <ul>
            
              
        <li><a href="/development/reference/supported-features.html">Cobalt support</a></li>
              
            
      </ul>
    </li>
          
        
      
  </ul>
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
      
<h4 class="no-submenu"><a href="/contributors/index.html">Contributors</a></h4>
      
    
</li>
  

  
<li class="expand-container" data-expander-target-search="relative">
    
      
      
<h4 class="no-submenu"><a href="/communication.html">Communication</a></h4>
      
    
</li>
  


      </ul>
    </div>
    <div class="col-md-3 show-share-buttons-bottom" id="rightCol">
      <div class="nav nav-stacked" id="tocSidebar">
        
        <div id="toc"></div>
        
          <div id="rightCol-share-buttons" class="share-buttons-bottom">
            

  


          </div>
        
      </div>
    </div>
    <div class="col-md-7" id="centerCol">
      <div id="content">
        <p>Provides definitions that allow for DRM support, which are common between Player
and Decoder interfaces.</p>

<h2 id="macros">Macros</h2>

<h3 id="ksbdrmsysteminvalid">kSbDrmSystemInvalid</h3>

<p>An invalid SbDrmSystem.</p>

<h3 id="ksbdrmticketinvalid">kSbDrmTicketInvalid</h3>

<p>A ticket for callback invocations initiated by the DRM system.</p>

<h2 id="enums">Enums</h2>

<h3 id="sbdrmkeystatus">SbDrmKeyStatus</h3>

<p>Status of a particular media key. <a href="https://w3c.github.io/encrypted-media/#idl-def-MediaKeyStatus">https://w3c.github.io/encrypted-media/#idl-def-MediaKeyStatus</a></p>

<h4 id="values">Values</h4>

<ul>
<li>  <code class="prettyprint">kSbDrmKeyStatusUsable</code></li>
<li>  <code class="prettyprint">kSbDrmKeyStatusExpired</code></li>
<li>  <code class="prettyprint">kSbDrmKeyStatusReleased</code></li>
<li>  <code class="prettyprint">kSbDrmKeyStatusRestricted</code></li>
<li>  <code class="prettyprint">kSbDrmKeyStatusDownscaled</code></li>
<li>  <code class="prettyprint">kSbDrmKeyStatusPending</code></li>
<li>  <code class="prettyprint">kSbDrmKeyStatusError</code></li>
</ul>

<h3 id="sbdrmsessionrequesttype">SbDrmSessionRequestType</h3>

<p>The type of the session request. <a href="https://www.w3.org/TR/encrypted-media/#idl-def-mediakeymessagetype">https://www.w3.org/TR/encrypted-media/#idl-def-mediakeymessagetype</a></p>

<h4 id="values">Values</h4>

<ul>
<li>  <code class="prettyprint">kSbDrmSessionRequestTypeLicenseRequest</code></li>
<li>  <code class="prettyprint">kSbDrmSessionRequestTypeLicenseRenewal</code></li>
<li>  <code class="prettyprint">kSbDrmSessionRequestTypeLicenseRelease</code></li>
<li>  <code class="prettyprint">kSbDrmSessionRequestTypeIndividualizationRequest</code></li>
</ul>

<h3 id="sbdrmstatus">SbDrmStatus</h3>

<p>The status of session related operations. Used by
<code class="prettyprint">SbDrmSessionUpdateRequestFunc</code>, <code class="prettyprint">SbDrmSessionUpdatedFunc</code>, and
<code class="prettyprint">SbDrmServerCertificateUpdatedFunc</code> to indicate the status of the operation. <a href="https://w3c.github.io/encrypted-media/#error-names">https://w3c.github.io/encrypted-media/#error-names</a></p>

<h4 id="values">Values</h4>

<ul>
<li>  <code class="prettyprint">kSbDrmStatusSuccess</code></li>
<li>  <code class="prettyprint">kSbDrmStatusTypeError</code></li>
<li>  <code class="prettyprint">kSbDrmStatusNotSupportedError</code></li>
<li>  <code class="prettyprint">kSbDrmStatusInvalidStateError</code></li>
<li>  <code class="prettyprint">kSbDrmStatusQuotaExceededError</code></li>
<li><p><code class="prettyprint">kSbDrmStatusUnknownError</code></p>

<p>The following error can be used when the error status cannot be mapped to
one of the above errors.</p></li>
</ul>

<h2 id="typedefs">Typedefs</h2>

<h3 id="sbdrmsessionclosedfunc">SbDrmSessionClosedFunc</h3>

<p>A callback for signalling that a session has been closed by the SbDrmSystem</p>

<h4 id="definition">Definition</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">typedef void(* SbDrmSessionClosedFunc) (SbDrmSystem drm_system, void *context, const void *session_id, int session_id_size)
</code></pre></div>
<h3 id="sbdrmsessionkeystatuseschangedfunc">SbDrmSessionKeyStatusesChangedFunc</h3>

<p>A callback for notifications that the status of one or more keys in a session
has been changed. All keys of the session and their new status will be passed
along. Any keys not in the list is considered as deleted.</p>

<h4 id="definition">Definition</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">typedef void(* SbDrmSessionKeyStatusesChangedFunc) (SbDrmSystem drm_system, void *context, const void *session_id, int session_id_size, int number_of_keys, const SbDrmKeyId *key_ids, const SbDrmKeyStatus *key_statuses)
</code></pre></div>
<h3 id="sbdrmsessionupdaterequestfunc">SbDrmSessionUpdateRequestFunc</h3>

<p>A callback that will receive generated session update request when requested
from a SbDrmSystem. <code class="prettyprint">drm_system</code> will be the DRM system that
SbDrmGenerateSessionUpdateRequest() was called on. <code class="prettyprint">context</code> will be the same
context that was passed into the call to SbDrmCreateSystem().<code class="prettyprint">ticket</code> will be
the same ticket that was passed to SbDrmGenerateSessionUpdateRequest() or
<code class="prettyprint">kSbDrmTicketInvalid</code> if the update request was generated by the DRM system.</p>

<p><code class="prettyprint">session_id</code> can be NULL if there was an error generating the request.</p>

<h4 id="definition">Definition</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">typedef void(* SbDrmSessionUpdateRequestFunc) (SbDrmSystem drm_system, void *context, int ticket, const void *session_id, int session_id_size, const void *content, int content_size, const char *url)
</code></pre></div>
<h3 id="sbdrmsessionupdatedfunc">SbDrmSessionUpdatedFunc</h3>

<p>A callback for notifications that a session has been added, and subsequent
encrypted samples are actively ready to be decoded. <code class="prettyprint">drm_system</code> will be the DRM
system that SbDrmUpdateSession() was called on. <code class="prettyprint">context</code> will be the same
context passed into that call to SbDrmCreateSystem().</p>

<p><code class="prettyprint">ticket</code> will be the same ticket that was passed to
SbDrmUpdateSession().<code class="prettyprint">succeeded</code> is whether the session was successfully updated
or not.</p>

<h4 id="definition">Definition</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">typedef void(* SbDrmSessionUpdatedFunc) (SbDrmSystem drm_system, void *context, int ticket, const void *session_id, int session_id_size, bool succeeded)
</code></pre></div>
<h3 id="sbdrmsystem">SbDrmSystem</h3>

<p>A handle to a DRM system which can be used with either an SbDecoder or a
SbPlayer.</p>

<h4 id="definition">Definition</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">typedef struct SbDrmSystemPrivate* SbDrmSystem
</code></pre></div>
<h2 id="structs">Structs</h2>

<h3 id="sbdrmkeyid">SbDrmKeyId</h3>

<h4 id="members">Members</h4>

<ul>
<li><p><code class="prettyprint">uint8_t identifier</code></p>

<p>The ID of the license (or key) required to decrypt this sample. For
PlayReady, this is the license GUID in packed little-endian binary form.</p></li>
<li><p><code class="prettyprint">int identifier_size</code></p></li>
</ul>

<h3 id="sbdrmsampleinfo">SbDrmSampleInfo</h3>

<p>All the optional information needed per sample for encrypted samples.</p>

<h4 id="members">Members</h4>

<ul>
<li><p><code class="prettyprint">uint8_t initialization_vector</code></p>

<p>The Initialization Vector needed to decrypt this sample.</p></li>
<li><p><code class="prettyprint">int initialization_vector_size</code></p></li>
<li><p><code class="prettyprint">uint8_t identifier</code></p>

<p>The ID of the license (or key) required to decrypt this sample. For
PlayReady, this is the license GUID in packed little-endian binary form.</p></li>
<li><p><code class="prettyprint">int identifier_size</code></p></li>
<li><p><code class="prettyprint">int32_t subsample_count</code></p>

<p>The number of subsamples in this sample, must be at least 1.</p></li>
<li><p><code class="prettyprint">constSbDrmSubSampleMapping* subsample_mapping</code></p>

<p>The clear/encrypted mapping of each subsample in this sample. This must be
an array of <code class="prettyprint">subsample_count</code> mappings.</p></li>
</ul>

<h3 id="sbdrmsubsamplemapping">SbDrmSubSampleMapping</h3>

<p>A mapping of clear and encrypted bytes for a single subsample. All subsamples
within a sample must be encrypted with the same encryption parameters. The clear
bytes always appear first in the sample.</p>

<h4 id="members">Members</h4>

<ul>
<li><p><code class="prettyprint">int32_t clear_byte_count</code></p>

<p>How many bytes of the corresponding subsample are not encrypted</p></li>
<li><p><code class="prettyprint">int32_t encrypted_byte_count</code></p>

<p>How many bytes of the corresponding subsample are encrypted.</p></li>
</ul>

<h2 id="functions">Functions</h2>

<h3 id="sbdrmclosesession">SbDrmCloseSession</h3>

<p>Clear any internal states/resources related to the specified <code class="prettyprint">session_id</code>.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">void SbDrmCloseSession(SbDrmSystem drm_system, const void *session_id, int session_id_size)
</code></pre></div>
<h3 id="sbdrmcreatesystem">SbDrmCreateSystem</h3>

<p>Creates a new DRM system that can be used when constructing an SbPlayer or an
SbDecoder.</p>

<p>This function returns kSbDrmSystemInvalid if <code class="prettyprint">key_system</code> is unsupported.</p>

<p>Also see the documentation of SbDrmGenerateSessionUpdateRequest() and
SbDrmUpdateSession() for more details.</p>

<p><code class="prettyprint">key_system</code>: The DRM key system to be created. The value should be in the form
of &quot;com.example.somesystem&quot; as suggested by <a href="https://w3c.github.io/encrypted-media/#key-system">https://w3c.github.io/encrypted-media/#key-system</a>) . All
letters in the value should be lowercase and will be matched exactly with known
DRM key systems of the platform. <code class="prettyprint">context</code>: A value passed when any of this
function&#39;s callback parameters are called. <code class="prettyprint">update_request_callback</code>: A function
that is called every time after SbDrmGenerateSessionUpdateRequest() is called.
<code class="prettyprint">session_updated_callback</code>: A function that is called every time after
SbDrmUpdateSession() is called. <code class="prettyprint">key_statuses_changed_callback</code>: A function that
can be called to indicate that key statuses have changed.
<code class="prettyprint">server_certificate_updated_callback</code>: A function that is called to report
whether the server certificate has been successfully updated. It is called once
and only once. It is possible that the callback is called before the function
returns. <code class="prettyprint">session_closed_callback</code>: A function that can be called to indicate
that a session has closed.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">SbDrmSystem SbDrmCreateSystem(const char *key_system, void *context, SbDrmSessionUpdateRequestFunc update_request_callback, SbDrmSessionUpdatedFunc session_updated_callback, SbDrmSessionKeyStatusesChangedFunc key_statuses_changed_callback, SbDrmSessionClosedFunc session_closed_callback)
</code></pre></div>
<h3 id="sbdrmdestroysystem">SbDrmDestroySystem</h3>

<p>Destroys <code class="prettyprint">drm_system</code>, which implicitly removes all keys installed in it and
invalidates all outstanding session update requests. A DRM system cannot be
destroyed unless any associated SbPlayer or SbDecoder has first been destroyed.</p>

<p>All callbacks are guaranteed to be finished when this function returns. As a
result, if this function is called from a callback that is passed to
SbDrmCreateSystem(), a deadlock will occur.</p>

<p><code class="prettyprint">drm_system</code>: The DRM system to be destroyed.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">void SbDrmDestroySystem(SbDrmSystem drm_system)
</code></pre></div>
<h3 id="sbdrmgeneratesessionupdaterequest">SbDrmGenerateSessionUpdateRequest</h3>

<p>Asynchronously generates a session update request payload for
<code class="prettyprint">initialization_data</code>, of <code class="prettyprint">initialization_data_size</code>, in case sensitive <code class="prettyprint">type</code>,
extracted from the media stream, in <code class="prettyprint">drm_system</code>&#39;s key system.</p>

<p>This function calls <code class="prettyprint">drm_system</code>&#39;s <code class="prettyprint">update_request_callback</code> function, which is
defined when the DRM system is created by SbDrmCreateSystem. When calling that
function, this function either sends <code class="prettyprint">context</code> (also from <code class="prettyprint">SbDrmCreateSystem</code>)
and a populated request, or it sends NULL <code class="prettyprint">session_id</code> if an error occurred.</p>

<p><code class="prettyprint">drm_system</code>&#39;s <code class="prettyprint">context</code> may be used to route callbacks back to an object
instance.</p>

<p>Callbacks may be called either from the current thread before this function
returns or from another thread.</p>

<p><code class="prettyprint">drm_system</code>: The DRM system that defines the key system used for the session
update request payload as well as the callback function that is called as a
result of the function being called.</p>

<p><code class="prettyprint">ticket</code>: The opaque ID that allows to distinguish callbacks from multiple
concurrent calls to SbDrmGenerateSessionUpdateRequest(), which will be passed to
<code class="prettyprint">update_request_callback</code> as-is. It is the responsibility of the caller to
establish ticket uniqueness, issuing multiple requests with the same ticket may
result in undefined behavior. The value <code class="prettyprint">kSbDrmTicketInvalid</code> must not be used.</p>

<p><code class="prettyprint">type</code>: The case-sensitive type of the session update request payload.
<code class="prettyprint">initialization_data</code>: The data for which the session update request payload is
created. <code class="prettyprint">initialization_data_size</code>: The size of the session update request
payload.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">void SbDrmGenerateSessionUpdateRequest(SbDrmSystem drm_system, int ticket, const char *type, const void *initialization_data, int initialization_data_size)
</code></pre></div>
<h3 id="sbdrmgetkeycount">SbDrmGetKeyCount</h3>

<p>Returns the number of keys installed in <code class="prettyprint">drm_system</code>.</p>

<p><code class="prettyprint">drm_system</code>: The system for which the number of installed keys is retrieved.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">int SbDrmGetKeyCount(SbDrmSystem drm_system)
</code></pre></div>
<h3 id="sbdrmgetkeystatus">SbDrmGetKeyStatus</h3>

<p>Gets <code class="prettyprint">out_key</code>, <code class="prettyprint">out_key_size</code>, and <code class="prettyprint">out_status</code> for the key with <code class="prettyprint">index</code> in
<code class="prettyprint">drm_system</code>. Returns whether a key is installed at <code class="prettyprint">index</code>. If not, the output
parameters, which all must not be NULL, will not be modified.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">bool SbDrmGetKeyStatus(SbDrmSystem drm_system, const void *session_id, int session_id_size, int index, void **out_key, int *out_key_size, SbDrmKeyStatus *out_status)
</code></pre></div>
<h3 id="sbdrmremoveallkeys">SbDrmRemoveAllKeys</h3>

<p>Removes all installed keys for <code class="prettyprint">drm_system</code>. Any outstanding session update
requests are also invalidated.</p>

<p><code class="prettyprint">drm_system</code>: The DRM system for which keys should be removed.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">void SbDrmRemoveAllKeys(SbDrmSystem drm_system)
</code></pre></div>
<h3 id="sbdrmsystemisvalid">SbDrmSystemIsValid</h3>

<p>Indicates whether <code class="prettyprint">drm_system</code> is a valid SbDrmSystem.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">static bool SbDrmSystemIsValid(SbDrmSystem drm)
</code></pre></div>
<h3 id="sbdrmticketisvalid">SbDrmTicketIsValid</h3>

<p>Indicates whether <code class="prettyprint">ticket</code> is a valid ticket.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">static bool SbDrmTicketIsValid(int ticket)
</code></pre></div>
<h3 id="sbdrmupdatesession">SbDrmUpdateSession</h3>

<p>Update session with <code class="prettyprint">key</code>, in <code class="prettyprint">drm_system</code>&#39;s key system, from the license server
response. Calls <code class="prettyprint">session_updated_callback</code> with <code class="prettyprint">context</code> and whether the update
succeeded. <code class="prettyprint">context</code> may be used to route callbacks back to an object instance.</p>

<p><code class="prettyprint">ticket</code> is the opaque ID that allows to distinguish callbacks from multiple
concurrent calls to SbDrmUpdateSession(), which will be passed to
<code class="prettyprint">session_updated_callback</code> as-is. It is the responsibility of the caller to
establish ticket uniqueness, issuing multiple calls with the same ticket may
result in undefined behavior.</p>

<p>Once the session is successfully updated, an SbPlayer or SbDecoder associated
with that DRM key system will be able to decrypt encrypted samples.</p>

<p><code class="prettyprint">drm_system</code>&#39;s <code class="prettyprint">session_updated_callback</code> may called either from the current
thread before this function returns or from another thread.</p>

<h4 id="declaration">Declaration</h4>
<div class="highlight"><pre><code class="language-text" data-lang="text">void SbDrmUpdateSession(SbDrmSystem drm_system, int ticket, const void *key, int key_size, const void *session_id, int session_id_size)
</code></pre></div>
        
          
            
          
        
      </div>
    </div>
  </div>

</div>


    
      <footer>
<div class="container">
    <div class="row">
      
        <div class="col-md-5 column-left">
          
          
            
              
  
    <span class="copyright-text">© Google 2019</span>
  


            
            
            
            
            
          
        </div>
      
        <div class="col-md-2 column-middle">
          
          
            
            
            
            
              
  <img class="footer-logo" src="/images/cobalt-logo.png" alt="Cobalt"/>


            
            
          
        </div>
      
<!--
          
          <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<div class="fb-share-button" data-href="/reference/starboard/modules/6/drm.html" data-layout=""></div>
&nbsp;
          <a href="https://twitter.com/" class="twitter-follow-button" data-show-screen-name="false" data-show-count="false" data-size=""></a>

<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>


-->
    </div>
</div>
</footer>

    

    <!-- TODO: Make sure no badness from moving common.js to styles.liquid -->

    
  </body>
</html>
